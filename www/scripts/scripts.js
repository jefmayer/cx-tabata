"use strict";var app=angular.module("cxTabataApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch"]);app.run(["$rootScope",function(a){a.bgColor="rgba(200,200,200,1)",a.workouts=storage.data.workouts}]),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/setup.html",controller:"SetupCtrl"}).when("/setup",{templateUrl:"views/setup.html",controller:"SetupCtrl"}).when("/workout",{templateUrl:"views/workout.html",controller:"WorkoutCtrl"}).when("/summary",{templateUrl:"views/summary.html",controller:"SummaryCtrl"}).otherwise({redirectTo:"/"})}]);var storage=function(){};storage.getWorkoutById=function(a){for(var b,c=storage.data.workouts.length,d=0;c>d;d++)if(b=storage.data.workouts[d],b.id===a)return b;return null},storage.data={workouts:[{name:"My 30 minute tabata trainer",id:"01",colorStart:0,time:1800,intervals:[{time:420,desc:"7 minutes easy"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:300,desc:"5 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:360,desc:"6 minutes easy"}]},{name:"Tabata trainer x 3",id:"02",colorStart:10,time:1800,intervals:[{time:300,desc:"5 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:240,desc:"4 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:240,desc:"4 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:240,desc:"4 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:300,desc:"5 minutes easy"}]}]},app.controller("SetupCtrl",["$scope","$rootScope","$location",function(a,b,c){a.hideWorkoutList=!1,b.bgColor="rgba(255,255,255,1)",b.isWorkout=!1,a.addWorkout=function(){console.log("Add workout.")},a.loadWorkout=function(d){b.data=storage.getWorkoutById(d),a.hideWorkoutList=!0;var e=setTimeout(function(){clearTimeout(e),a.$apply(function(){c.path("/workout")})},200)}}]),app.controller("WorkoutCtrl",["$scope","$rootScope","$location",function(a,b,c){function d(b,c){a.total.mins=g(Math.floor(c/s)),a.total.secs=g(Math.floor(c%s/r)),a.total.msecs=Math.floor(c%r)/100,a.interval.mins=g(Math.floor(b/s)),a.interval.secs=g(Math.floor(b%s/r)),a.interval.msecs=Math.floor(b%r)/100}function e(a,b,c,d,e,f,g,h,i){void 0===g&&(g=128),void 0===h&&(h=127),void 0===i&&(i=50);for(var j=0;i>j;++j){var k=Math.round(Math.sin(a*j+d)*h+g),l=Math.round(Math.sin(b*j+e)*h+g),m=Math.round(Math.sin(c*j+f)*h+g);t.push("rgba("+k+","+l+","+m+",1)")}}function f(){l+=100,(l===o+q*r||n)&&(n=!1,q=parseInt(b.data.intervals[p].time),o=l,a.$apply(function(){a.interval.desc=b.data.intervals[p].desc,void 0===b.data.intervals[p+1]?a.next.desc="Training complete":a.next.desc=h(b.data.intervals[p+1].desc)+" is next"}),p+=1),a.$apply(function(){var a;a=l===v?0:o+q*r-l,d(a,l),l%1e4===0&&(b.bgColor=t[m],m+=1,m===t.length&&(m=0)),l===v&&(clearInterval(k),c.path("/summary"))})}function g(a){return a+="",a.length<2?"0"+a:a}function h(a){return a.charAt(0).toUpperCase()+a.slice(1)}function i(){a.countdownStarted=!0;var b=5,c=setInterval(function(){b-=1,0===b?(clearInterval(c),u=!0,a.countdownStarted=!1,j()):a.$apply(function(){a.countdownAt=b})},1e3)}function j(){k=setInterval(f,100)}if(void 0===b.data)return void c.path("/setup");b.isWorkout=!0,a.isStarted=!1,a.isPaused=!1,a.isMouseover=!1,a.workoutName=b.data.name,a.countdownAt=5,a.countdownStarted=!1,a.interval={mins:"00",secs:"00",msecs:"0",desc:""},a.total={mins:"00",secs:"00",msecs:"0"},a.next={desc:""};var k,l=0,m=b.data.colorStart,n=!0,o=0,p=0,q=0,r=1e3,s=60*r,t=[],u=!1,v=b.data.time*r;d(v,0),e(.3,.3,.3,0,2,4),b.bgColor=t[b.data.colorStart],a.start=function(){a.isStarted=!0,(a.isStarted||a.isPaused)&&(a.isPaused=!1,u?j():i())},a.pause=function(){null!==k?(a.isPaused=!0,clearInterval(k),k=null):(a.isPaused=!1,k=setInterval(f,100)),a.isMouseover=!1},a.reset=function(){null!==k&&(l=0,m=b.data.colorStart,n=!0,o=0,p=0,q=0,clearInterval(k),k=null,d(v,0),a.isStarted=!1,a.isMouseover=!1)},a.onMousedown=function(){a.isStarted&&(a.isPaused||(a.isMouseover=!0))},a.onMouseleave=function(){a.isMouseover=!1},a.$on("$destroy",function(){console.log("destroy"),null!==k&&(clearInterval(k),k=null)})}]),app.controller("SummaryCtrl",["$scope",function(a){console.log(a)}]);