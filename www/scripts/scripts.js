"use strict";var app=angular.module("cxTabataApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch"]);app.run(["$rootScope",function(a){a.bgColor="rgba(200,200,200,1)",a.workouts=storage.data.workouts}]),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/setup.html",controller:"SetupCtrl"}).when("/setup",{templateUrl:"views/setup.html",controller:"SetupCtrl"}).when("/workout",{templateUrl:"views/workout.html",controller:"WorkoutCtrl"}).when("/summary",{templateUrl:"views/summary.html",controller:"SummaryCtrl"}).otherwise({redirectTo:"/"})}]);var storage=function(){};storage.getWorkoutById=function(a){for(var b,c=storage.data.workouts.length,d=0;c>d;d++)if(b=storage.data.workouts[d],b.id===a)return b;return null},storage.data={workouts:[{name:"My 30 minute tabata trainer",id:"01",time:1800,intervals:[{time:420,desc:"7 minutes easy"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:60,desc:"increase by one gear"},{time:300,desc:"5 minutes easy"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:20,desc:"tabata intense"},{time:10,desc:"tabata recovery"},{time:360,desc:"6 minutes easy"}]}]},app.controller("SetupCtrl",["$scope","$rootScope","$location",function(a,b,c){a.hideWorkoutList=!1,b.bgColor="rgba(255,255,255,1)",b.isWorkout=!1,a.addWorkout=function(){console.log("Add workout.")},a.loadWorkout=function(d){b.data=storage.getWorkoutById(d),a.hideWorkoutList=!0;var e=setTimeout(function(){clearTimeout(e),a.$apply(function(){c.path("/workout")})},200)}}]),app.controller("WorkoutCtrl",["$scope","$rootScope","$location",function(a,b,c){function d(b,c){a.total.mins=g(Math.floor(c/p)),a.total.secs=g(Math.floor(c%p/o)),a.total.msecs=Math.floor(c%o)/100,a.interval.mins=g(Math.floor(b/p)),a.interval.secs=g(Math.floor(b%p/o)),a.interval.msecs=Math.floor(b%o)/100}function e(a,b,c,d,e,f,g,h,i){void 0===g&&(g=128),void 0===h&&(h=127),void 0===i&&(i=50);for(var j=0;i>j;++j){var k=Math.round(Math.sin(a*j+d)*h+g),l=Math.round(Math.sin(b*j+e)*h+g),m=Math.round(Math.sin(c*j+f)*h+g);q.push("rgba("+k+","+l+","+m+",1)")}}function f(){i+=100,(i===l+n*o||k)&&(k=!1,n=parseInt(b.data.intervals[m].time),l=i,a.$apply(function(){a.interval.desc=b.data.intervals[m].desc,a.next.desc=b.data.intervals[m+1].desc}),m+=1),a.$apply(function(){var a;a=i===r?0:l+n*o-i,d(a,i),i%1e4===0&&(b.bgColor=q[j],j+=1,j===q.length&&(j=0)),i===r&&(clearInterval(h),c.path("/summary"))})}function g(a){return a+="",a.length<2?"0"+a:a}if(void 0===b.data)return void c.path("/setup");b.isWorkout=!0,a.isStarted=!1,a.isPaused=!1,a.isMousedown=!1,a.workoutName=b.data.name,a.interval={mins:"00",secs:"00",msecs:"0",desc:""},a.total={mins:"00",secs:"00",msecs:"0"},a.next={desc:""};var h,i=0,j=0,k=!0,l=0,m=0,n=0,o=1e3,p=60*o,q=[],r=b.data.time*o;d(r,0),e(.3,.3,.3,0,2,4),b.bgColor=q[0],a.start=function(){a.isStarted=!0,a.isStarted&&(h=setInterval(f,100))},a.pause=function(){null!==h?(clearInterval(h),h=null):h=setInterval(f,100),a.isMousedown=!1},a.reset=function(){null!==h&&(i=0,j=0,k=!0,l=0,m=0,n=0,clearInterval(h),h=null,d(r,0),a.isStarted=!1,a.isMousedown=!1)},a.onMousedown=function(){a.isStarted&&(a.isMousedown=!0)},a.onMouseup=function(){a.isMousedown=!1},a.$on("$destroy",function(){console.log("destroy"),null!==h&&(clearInterval(h),h=null)})}]),app.controller("SummaryCtrl",["$scope",function(a){console.log(a)}]);